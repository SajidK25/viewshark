function doinput(l,a,e,t){if(typeof $("#"+a+"-form-c").html()=="undefined"){f='<form id="'+a+'-form-c" method="post" action="" class="entry-form-class c-entry-form-edit" style="display: none;"><input type="hidden" name="ekey[]" value="'+a+'"><input type="hidden" name="efile[]" value="'+e+'"></form>';$("#upload-wrapper:first").append(f)}if(l=="description"){ht='<textarea name="c_entry_description['+a+']">'+t+"</textarea>";if(typeof $("textarea[name='c_entry_"+l+"["+a+"]']").html()=="undefined"){$("#"+a+"-form-c").append(ht)}else{$("textarea[name='c_entry_"+l+"["+a+"]']").val(t)}}else{ht='<input type="text" name="c_entry_'+l+"["+a+']" value="'+t+'">';if(typeof $("input[name='c_entry_"+l+"["+a+"]']").html()=="undefined"){$("#"+a+"-form-c").append(ht)}else{$("input[name='c_entry_"+l+"["+a+"]']").val(t)}}}(function(f,s){var p={};function o(l){return plupload.translate(l)||l}function c(l,a){var e="fe";a.contents().each(function(l,a){a=f(a);if(!a.is(".plupload")){a.remove()}});var t="";if(f("#UFBE").val()=="1"){t=" off"}var i=f("#upload_category").parent().html();f("#upload_category").detach();var d=f("#upload-category").text();var s=d=="auto"?" no-display":"";var p='<div class="selector entry-form-class'+s+'">'+i+"</div>";var o='<div id="dobrowse" style="display: block;"><a href="#" class="plupload_button browse'+t+'" id="'+l+'_browse"><i rel="tooltip" title="'+upload_lang["select"]+'" class="iconBe-plus'+(d=="auto"?" no-categ":"")+'"></i></a><a href="#" class="plupload_button plupload_start start off"><i rel="tooltip" title="'+upload_lang["start"]+'" class="iconBe-upload"></i></a></div>';var n=o;var u='<div id="sb-search" class="sb-search sb-search-open"><div><input class="sb-search-input" type="text" value="" name="sq" id="sq" placeholder="Assign Username"><input type="hidden" name="assign_username" id="assign-username" value="" size="10"><input class="sb-search-submit file-search" id="file-search-button" type="button" value="" rel="tooltip" title="'+upload_lang["assign"]+'"><span class="sb-icon-search"></span></div></div>';if(f("#UFBE").val()!="1"){u=""}var r='<div class="upload-buttons'+(d=="auto"?" no-categ":"")+'">'+u+n+" </div>";var c='<div class="plupload_progress"><div class="plupload_progress_container"><span class="plupload_total_status">0%</span><span class="plupload_total_file_size">&nbsp;</span><span class="plupload_progress_bar" style="width: 0%;"></span></div></div>';var _='<div class="vs-column full">'+c+"</div>";a.prepend('<div id="ct-wrapper" class="wdmax entry-list"><div class="section-top-bar"><div class="vs-column half upload-left-fix">'+p+r+'</div><div class="vs-column half fit upload-right-fix">'+_+'</div><div class="clearfix"></div></div></div>'+'<div class="plupload_wrapper plupload_scroll">'+'<div id="'+l+'_container" class="plupload_container">'+'<div class="plupload">'+'<div class="plupload_header" style="display: none;">'+'<div class="plupload_header_content">'+'<div class="plupload_header_title">'+upload_lang["h1"]+"</div>"+'<div class="plupload_header_text">'+upload_lang["h2"]+"</div>"+"</div>"+"</div>"+'<div class="plupload_content">'+'<div class="plupload_filelist_header">'+'<div class="plupload_file_name">'+upload_lang["filename"]+"</div>"+'<div class="plupload_file_action">Remove</div>'+'<div class="plupload_file_status"><span>'+upload_lang["status"]+"</span></div>"+'<div class="plupload_file_size">'+upload_lang["size"]+"</div>"+'<div class="plupload_clearer">&nbsp;</div>'+"</div>"+'<ul id="'+l+'_filelist" class="plupload_filelist"></ul>'+"</div>"+"</div>"+"</div>"+'<input type="hidden" id="'+l+'_count" name="'+l+'_count" value="0" />'+"</div>")}f.fn.pluploadQueue=function(d){if(d){this.each(function(){var n,e,u,l;e=f(this);u=e.attr("id");if(!u){u=plupload.guid();e.attr("id",u)}l=e.html();c(u,e);d=f.extend({dragdrop:true,browse_button:u+"_browse",container:u},d);if(d.dragdrop){d.drop_element=u+"_filelist"}n=new plupload.Uploader(d);p[u]=n;function r(l){var a;var e;if(l.status==plupload.DONE){a="plupload_done";e="icon-check"}if(l.status==plupload.FAILED){a="plupload_failed";e="iconBe-info"}if(l.status==plupload.QUEUED){a="plupload_delete";e="icon-times"}if(l.status==plupload.UPLOADING){a="plupload_uploading"}var t=f("#"+l.id).attr("class",a).find("a").css("display","block");f("#"+l.id).find("i.pl_status").attr("class",e);if(l.hint){t.attr("title",l.hint)}}function t(){f("span.plupload_total_status",e).html(n.total.percent+"%");f("span.plupload_progress_bar",e).css("width",n.total.percent+"%");f("span.plupload_upload_status",e).html(s.sprintf(o("Uploaded %d/%d files"),n.total.uploaded,n.files.length));if(n.total.percent>52){f(".plupload_total_status").css("color","white")}else{f(".plupload_total_status").css("color","black")}}function a(){var s=f("ul.plupload_filelist",e).html(""),p=0,o;f.each(n.files,function(l,a){o="";if(a.status==plupload.DONE){if(a.target_name){o+='<input type="hidden" name="'+u+"_"+p+'_tmpname" value="'+plupload.xmlEncode(a.target_name)+'" />'}o+='<input type="hidden" name="'+u+"_"+p+'_name" value="'+plupload.xmlEncode(a.name)+'" />';o+='<input type="hidden" name="'+u+"_"+p+'_status" value="'+(a.status==plupload.DONE?"done":"failed")+'" />';p++;f("#"+u+"_count").val(p)}var e=f("#upload_category").parent().html().replace(/upload_category/g,"upload_category_"+a.id).replace(/file_category_0/g,"upload_category_"+a.id).replace(/file_category_sel/g,"upload_category_"+a.id);var t=f("#upload-category").text();var i=t=="auto"?" no-display-off":"";var d='<div class="selector no-entry-form-class'+i+'">'+e+"</div>";s.append('<li id="'+a.id+'">'+'<div class="plupload_file_name"><span>'+a.name+'</span><i class="icon-pencil entry-edit-icon" rel="tooltip" title="Edit file details" onclick=\'$("#'+a.id+'-edit").stop().slideToggle("fast")\'></i></div>'+'<div class="plupload_file_action"><a href="javascript:;"><i class="pl_status"></i></a></div>'+'<div class="plupload_file_status">'+a.percent+"%</div>"+'<div class="plupload_file_size">'+plupload.formatSize(a.size)+"</div>"+'<div class="plupload_clearer">&nbsp;</div>'+o+"</li>"+'<li id="'+a.id+'-edit" class="pl-entry-edit" style="display: none;">'+'<form id="'+a.id+'-form" method="post" action="" class="entry-form-class entry-form-edit">'+'<div class="plupload_file_name_off">'+'<label>Title: </label><input type="text" name="entry_title_'+a.id+"\" onkeyup=\"doinput('title', '"+a.id+"', '"+a.name+'\', this.value)" value="'+(typeof f("input[name='c_entry_title["+a.id+"]']").html()=="undefined"?a.name.replace(/\.[^/.]+$/,""):f("input[name='c_entry_title["+a.id+"]']").val())+'"><br>'+'<label>Description: </label><textarea name="entry_description_'+a.id+"\" onkeyup=\"doinput('description', '"+a.id+"', '"+a.name+"', this.value)\">"+(typeof f("textarea[name='c_entry_description["+a.id+"]']").html()=="undefined"?a.name.replace(/\.[^/.]+$/,""):f("textarea[name='c_entry_description["+a.id+"]']").val())+"</textarea><br>"+'<label>Tags: </label><input type="text" name="entry_tags_'+a.id+"\" onkeyup=\"doinput('tags', '"+a.id+"', '"+a.name+'\', this.value)" value="'+(typeof f("input[name='c_entry_tags["+a.id+"]']").html()=="undefined"?a.name.replace(/\.[^/.]+$/,""):f("input[name='c_entry_tags["+a.id+"]']").val())+'"><br>'+"<label>Category: </label><br>"+d+"</div>"+'<div class="plupload_clearer">&nbsp;</div>'+'</form><div class="clearfix"></div>'+"</li>");r(a);f("#select-box-upload_category_"+a.id+":last").detach();SelectList.init(f("#upload_category_"+a.id).attr("name"));f("#upload_category_"+a.id).change(function(){doinput("category",a.id,a.name,this.value)});f("#"+a.id+".plupload_delete a").click(function(l){f("#"+a.id+"-form-c").detach();f("#"+a.id).remove();n.removeFile(a);l.preventDefault()})});f("a.plupload_start",e).toggleClass("plupload_disabled",n.files.length==n.total.uploaded+n.total.failed);s[0].scrollTop=s[0].scrollHeight;t();if(!n.files.length&&n.features.dragdrop&&n.settings.dragdrop){f("#"+u+"_filelist").append('<li class="plupload_droptext">'+upload_lang["drag"].replace("##",n.settings.max_files)+"</li>")}}function i(){delete p[u];n.destroy();e.html(l);n=e=l=null}n.bind("UploadFile",function(l,a){f("#"+a.id).addClass("plupload_current_file")});n.bind("Init",function(s,l){if(!d.unique_names&&d.rename){e.on("click","#"+u+"_filelist div.plupload_file_name span",function(l){var e=f(l.target),t,a,i,d="";t=s.getFile(e.parents("li")[0].id);i=t.name;a=/^(.+)(\.[^.]+)$/.exec(i);if(a){i=a[1];d=a[2]}e.hide().after('<input type="text" />');e.next().val(i).focus().blur(function(){e.show().next().remove()}).keydown(function(l){var a=f(this);if(l.keyCode==13){l.preventDefault();t.name=a.val()+d;e.html(t.name);a.blur()}})})}f("a.plupload_start",e).click(function(l){if(!f(this).hasClass("plupload_disabled")){n.start()}l.preventDefault()});f("a.plupload_stop",e).click(function(l){l.preventDefault();n.stop()});f("a.plupload_start",e).addClass("plupload_disabled")});n.bind("Error",function(l,a){var e=a.file,t;if(e){t=a.message;if(a.details){t+=" ("+a.details+")"}if(a.code==plupload.FILE_SIZE_ERROR){alert(o("Error: File too large:")+" "+e.name)}if(a.code==plupload.FILE_EXTENSION_ERROR){alert(o("Error: Invalid file extension:")+" "+e.name)}e.hint=t;f("#"+e.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",t)}if(a.code===plupload.INIT_ERROR){setTimeout(function(){i()},1)}});n.bind("PostInit",function(l){if(l.settings.dragdrop&&l.features.dragdrop){f("#"+u+"_filelist").append('<li class="plupload_droptext">'+upload_lang["drag"].replace("##",l.settings.max_files)+"</li>")}});n.init();n.bind("StateChanged",function(){if(n.state===plupload.STARTED){f("li.plupload_delete a,div.plupload_buttons",e).hide();f("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",e).css("display","block");if(d.multiple_queues){}}else{a();f("a.plupload_delete",e).css("display","block");if(d.multiple_queues&&n.total.uploaded+n.total.failed==n.files.length){f(".plupload_buttons,.plupload_upload_status",e).css("display","inline");f(".plupload_start",e).addClass("plupload_disabled")}}});n.bind("FilesAdded",a);n.bind("FilesRemoved",function(){var l=f("#"+u+"_filelist").scrollTop();a();f("#"+u+"_filelist").scrollTop(l)});n.bind("FileUploaded",function(l,a){r(a)});n.bind("UploadProgress",function(l,a){f("#"+a.id+" div.plupload_file_status",e).html(a.percent+"%");r(a);t()});if(d.setup){d.setup(n)}});return this}else{return p[f(this[0]).attr("id")]}}})(jQuery,mOxie);